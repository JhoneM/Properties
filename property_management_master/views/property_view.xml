<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!-- Árbol -->
    <record model="ir.ui.view" id="property_tree_view">
        <field name="name">property.tree</field>
        <field name="model">property.management.property</field>
        <field name="arch" type="xml">
            <tree string="Lista de propiedades">
                <field name="name" />
                <field name="type_id" />
                <field name="total_area" />
                <field name="builded_surface" />
                <field name="city" string="Región" />
                <field name="state_id" string="Comuna" />
                <field name="state_prop_id" />
                <field name="sale_price" />
                <field name="sale_price_currency" />
                <field name="lease_price" />
                <field name="lease_price_currency" />
            </tree>
        </field>
    </record>

    <!-- Kanban -->
    <record model="ir.ui.view" id="property_kanban_view">
        <field name="name">property.kanban</field>
        <field name="model">property.management.property</field>
        <field name="priority" eval="1"/>
        <field name="arch" type="xml">
            <kanban default_group_by="state_prop_id" class="o_kanban_small_column o_opportunity_kanban" group_edit="true" group_delete="true" group_create="true" >
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_global_click">
                            <div class="oe_kanban_content">
                                <div>
                                    <strong class="o_kanban_record_title"><field name="name"/></strong>
                                </div>
                                <div class="o_kanban_record_subtitle">
                                    <t t-if="record.type_id.raw_value">
                                        <field name="type_id"/>
                                    </t>
                                    <br />
                                    <t t-if="record.street_kanban_report">
                                        <field name="street_kanban_report"/>
                                    </t>
                                    <t t-if="record.street2_kanban_report">
                                        <field name="street2_kanban_report"/>
                                    </t>
                                    <t t-if="record.state_kanban_report">
                                        <field name="state_kanban_report" />
                                    </t>
                                    <t t-if="record.city.raw_value">
                                        <field name="city"/>
                                    </t>
                                </div>
                            </div>
                            <div class="oe_clear"/>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Formulario -->
    <record model="ir.ui.view" id="property_form_view">
        <field name="name">property.form</field>
        <field name="model">property.management.property</field>
        <field name="arch" type="xml">
            <form string="Formulario" class="o_lead_opportunity_form">
                <field name="active"  attrs="{'invisible': True}" />

                <header>
                    <field name="state_prop_id" widget="statusbar" options="{'clickable': '1', 'fold_field': 'fold'}" />
                </header>
                <sheet>

                    <div class="oe_button_box" name="button_box">
                        <button name="website_publish_button" type="object" class="oe_stat_button" icon="fa-globe">
                            <field name="is_published" widget="website_publish_button"/>
                        </button>
                    </div>

                    <field name="image_1920" widget="image" class="oe_avatar" options="{&quot;preview_image&quot;: &quot;image_128&quot;}" />
                    <div class="oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1>
                            <field name="name" placeholder="Nombre" required="1" />
                        </h1>
                    </div>
                    <group>
                        <field name="type_id" required="1" options="{'no_create_edit': True, 'no_open':True}" />
                        <field name="partner_id" required="1" />
                    </group>
                    <group  string="Tipo de operación">
                        <field name="real_estate_lease"/>
                        <field name="real_estate_sale"/>
                    </group>
                    <notebook colspan="4">
                        <page string="General" autofocus="autofocus">
                            <group>
                                <group>
                                    <div class="container">
                                        <div class="row">
                                            <div class="col-12">
                                                <group>
                                                    <label for="street" string="Dirección" />
                                                    <div>
                                                        <div class="o_address_format" name="div_address">
                                                            <field name="street" placeholder="Calle..." class="o_address_street"/>
                                                            <field name="street2" placeholder="Calle 2..." class="o_address_street"/>
                                                            <field name="state_id" class="o_address_state" placeholder="Comuna" options="{&quot;no_open&quot;: True}" context="{'country_id': country_id, 'zip': zip}"/>
                                                            <field name="city" placeholder="Región" class="o_address_city"/>
                                                            <field name="zip" placeholder="C.P." class="o_address_zip"/>
                                                            <field name="country_id" placeholder="País" class="o_address_country" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}"/>                                                                                                                                                                                    
                                                        </div>
                                                    </div>
                                                    <label for="property_coordenada" string="Coordenadas Mapa" />
                                                    <div>
                                                        <field name="property_coordenada" placeholder="Coordenadas"/>
                                                    </div>
                                                    <label for="zoom" string="Zoom" />
                                                    <div>    
                                                        <field name="zoom" placeholder="Zoom Mapa"/>                                                    
                                                    </div>
                                                </group>
                                            </div>
                                            <div class="col-12">
                                                <group>
                                                    <div>
                                                        <field name="property_maps" readonly="1" force_save="1" />
                                                    </div>
                                                </group>
                                            </div>
                                        </div>
                                    </div>        
                                </group>
                                <group>
                                    <field name="total_area" />
                                    <field name="builded_surface" />
                                    <field name="bedroom_quantity"  />
                                    <field name="dependencies"  />
                                    <field name="cellar"  />
                                    <field name="parking"  />
                                    <field name="amb_ids" widget="many2many_tags" options="{'no_create_edit': True}" />
                                    <field name="orientation_id" options="{'no_create_edit': True, 'no_open':True}"  />
                                    <field name="tag_ids" widget="many2many_tags" options="{'no_create_edit': True}" />
                                </group>
                            </group>
                        </page>
                        <page string="Comunidad">
                            <group>
                                <group>
                                    <field name="community_name"  />
                                    <field name="construction_company_id" options="{'no_create_edit': True}" domain="[('construction_company', '=', True)]" />
                                    <field name="floor_quantity"  />
                                    <field name="dep_x_floor"  />
                                    <field name="num_floor"  />
                                    <field name="elevator"  />
                                    <field name="amenities" widget="many2many_tags" />
                                    <field name="restrictions" widget="many2many_tags" />
                                </group>
                                <group>
                                    <field name="cons_year" />
                                    <field name="num_rol" placeholder="XXXXX-XXXXX" />

                                </group>
                            </group>
                        </page>
                        <page string="Financiera">
                            <group>
                                <group>
                                    <field name="real_estate_agent"/>
                                    <label for="sale_price" attrs="{'invisible': [('real_estate_sale', '=', False)]}"/>
                                    <div>
                                        <field name="sale_price" 
                                               class="oe_inline" 
                                               style="width: 30% !important;" 
                                               attrs="{'invisible': [('real_estate_sale', '=', False)]}"
                                        />
                                        &#x2063; &#x2063;
                                        <field name="sale_price_currency" 
                                               options="{'no_create_edit': True, 'no_open':True}"  
                                               nolabel="1" style="width: 30% !important;" 
                                               class="oe_inline"
                                               attrs="{'invisible': [('real_estate_sale', '=', False)]}" 
                                        />
                                    </div>
                                    <label for="lease_price" attrs="{'invisible': [('real_estate_lease', '=', False)]}"/>
                                    <div>
                                        <field name="lease_price" 
                                               class="oe_inline" 
                                               style="width: 30% !important;" 
                                               attrs="{'invisible': [('real_estate_lease', '=', False)]}"
                                        />
                                        &#x2063; &#x2063;
                                        <field name="lease_price_currency" 
                                               options="{'no_create_edit': True, 'no_open':True}"  
                                               nolabel="1" 
                                               style="width: 30% !important;" 
                                               class="oe_inline" 
                                               attrs="{'invisible': [('real_estate_lease', '=', False)]}"
                                        />
                                    </div>
                                </group>
                                <group>
                                    <label for="common_expenses"/>
                                    <div>
                                        <field name="common_expenses" class="oe_inline" style="width: 30% !important;" />
                                        &#x2063; &#x2063;
                                        <field name="common_expenses_currency" options="{'no_create_edit': True, 'no_open':True}"  nolabel="1" style="width: 30% !important;" class="oe_inline" />
                                    </div>
                                    <label for="contributions"/>
                                    <div>
                                        <field name="contributions" class="oe_inline" style="width: 30% !important;" />
                                        &#x2063; &#x2063;
                                        <field name="contributions_currency" options="{'no_create_edit': True, 'no_open':True}"  nolabel="1" style="width: 30% !important;" class="oe_inline" />
                                    </div>
                                    <label for="tax_assessment"/>
                                    <div>
                                        <field name="tax_assessment" class="oe_inline" style="width: 30% !important;" />
                                        &#x2063; &#x2063;
                                        <field name="tax_assessment_currency" options="{'no_create_edit': True, 'no_open':True}"  nolabel="1" style="width: 30% !important;" class="oe_inline" />
                                    </div>
                                    <label for="commercial_appraisal"/>
                                    <div>
                                        <field name="commercial_appraisal" class="oe_inline" style="width: 30% !important;" />
                                        &#x2063; &#x2063;
                                        <field name="commercial_appraisal_currency" options="{'no_create_edit': True, 'no_open':True}"  nolabel="1" style="width: 30% !important;" class="oe_inline" />
                                    </div>
                                </group>
                            </group>
                        </page>
                        <page string="Captación">
                            <group>
                                <group>
                                    <field name="exclusiveness" string="Exclusividad" />
                                    <field name="expiration_date" attrs="{'invisible':[('exclusiveness', '=', False)]}" />
                                    <label for="compute_price"/>
                                    <div class="container">
                                        <div class="row">
                                            <div class="col" style="padding-left:0; padding-right:0; margin-top: 5px;">
                                                <field name="compute_price" string="Compute Price" class="oe_inline" widget="radio" style="padding-right: 3% !important;"/>
                                            </div>
                                            <div class="col" style="padding-left:0; padding-right:0;">
                                                <field name="agreed_commission_fixed" widget="float" style="width:80%; text-align:right;" /><span>&amp;nbsp;$</span>
                                                <field name="agreed_commission_percent" widget="float" style="width:80%; text-align:right;"/><span>&amp;nbsp;%</span>
                                            </div>
                                            <div class="col" style="padding-left:0; padding-right:0;">
                                                <field name="agreed_commission_currency" options="{'no_create_edit': True, 'no_open':True}"  nolabel="1" class="oe_inline" /><br/>
                                            </div>
                                        </div>    
                                    </div>
                                    <field name="visiting_hours"  />
                                    <field name="sign" string="Letrero" />
                                    <field name="key"/>
                                </group>
                                <group>
                                    <field name="origin_name" attrs="{'invisible': True}"/>
                                    <field name="origin_property" string="Origen" />
                                    <field name="broker" attrs="{'invisible':[('origin_name', '!=', 'Externo')]}" />
                                    <field name="employee" attrs="{'invisible':[('origin_name', '!=', 'Empleado')]}" />
                                </group>
                            </group>
                        </page>
                        <page string="Media">
                            <group>
                                <field name="virtual_tour" widget="url" />
                                <field name="video" widget="url" />
                            </group>
                            <group string="Fotografias">
                                <field name="image_ids" mode="kanban" class="o_website_sale_image_list" default_group_by="columns" options="{'create_text':'Agregar Foto'}" nolabel="1"/>
                            </group>                                
                        </page>
                        <page string="Publicación">
                            <group>
                                <field name="head"/>
                                <field name="description"/>
                            </group>
                        </page>
                        <page string="Documentación">
                            <field name="attachments" nolabel="1">
                                <tree editable="1" delete="1">
                                    <field name="name" />
                                    <field name="attachments" />
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" />
                    <field name="activity_ids" widget="mail_activity" />
                    <field
                        name="message_ids"
                        widget="mail_thread"
                        options="{'post_refresh': 'recipients'}"
                    />
                </div>
            </form>
        </field> 
    </record>

    <!-- Acción -->
    <record model="ir.actions.act_window" id="property_management_property">
        <field name="name">Propiedades</field>
        <field name="res_model">property.management.property</field>
        <field name="view_mode">kanban,tree,search,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">Acá se listan las propiedades</p>
        </field>
    </record>

</odoo>
